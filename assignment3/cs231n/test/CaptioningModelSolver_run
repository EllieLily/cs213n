# solver log : 图片处理成h的初始化状态, 之后x的每个输出为这个图片描述的字符串序列

idx_to_word <type 'list'> 1004
train_captions <type 'numpy.ndarray'> (400135L, 17L) int32
val_captions <type 'numpy.ndarray'> (195954L, 17L) int32
train_image_idxs <type 'numpy.ndarray'> (400135L,) int32
val_features <type 'numpy.ndarray'> (40504L, 512L) float32
val_image_idxs <type 'numpy.ndarray'> (195954L,) int32
train_features <type 'numpy.ndarray'> (82783L, 512L) float32
train_urls <type 'numpy.ndarray'> (82783L,) |S63
val_urls <type 'numpy.ndarray'> (40504L,) |S63
word_to_idx <type 'dict'> 1004
{u'slope': 228, u'all': 317, u'pointing': 865, u'skis': 156, u'people': 19, u'yellow': 113, u'four': 234, u'skate': 241, u'asian': 749, u'skiing': 236, u'go': 798, u'chair': 170, u'children': 274, u'row': 409, u'feeding': 629, u'tv': 297, u'fenced': 641, u'young': 49, u'suits': 935, u'to': 13, u'bicycles': 713, u'bike': 226, u'device': 917, u'under': 147, u'cluttered': 774, u'enjoying': 594, u'furniture': 436, u'brown': 112, u'woman': 23, u'garden': 799, u'sitting': 14, u'very': 142, u'dessert': 737, u'blanket': 500, u'wave': 196, u'cutting': 270, u'spoon': 758, u'closeup': 615, u'messy': 888, u'kitten': 847, u'drinking': 461, u'fireplace': 659, u'reading': 582, u'wooded': 812, u'clouds': 837, u'couches': 765, u'wooden': 99, u'laying': 95, u'bright': 498, u'cloudy': 443, u'large': 29, u'sand': 411, u'woods': 619, u'subway': 746, u'team': 791, u'small': 37, u'bench': 103, u'sidewalk': 195, u'rack': 699, u'clothes': 696, u'cap': 995, u'bicycle': 349, u'fence': 184, u'phones': 617, u'hanging': 257, u'sign': 59, u'past': 440, u'dish': 505, u'street': 25, u'video': 300, u'traveling': 305, u'eating': 109, u'drinks': 642, u'blue': 60, u'what': 972, u'plays': 706, u'stands': 167, u'clock': 91, u'giving': 948, u'sun': 511, u'cooking': 576, u'near': 38, u'uniform': 513, u'cell': 176, u'lights': 340, u'waiting': 338, u'poles': 637, u'above': 239, u'cars': 202, u'new': 875, u'net': 918, u'ground': 208, u'racing': 980, u'bird': 178, u'filled': 146, u'body': 315, u'<END>': 2, u'full': 219, u'sinks': 704, u'gathered': 607, u'men': 81, u'commercial': 721, u'french': 777, u'herd': 263, u'water': 52, u'tracks': 203, u'apartment': 1003, u'baseball': 53, u'sink': 117, u'others': 580, u'alone': 681, u'path': 548, u'along': 221, u'appears': 922, u'box': 294, u'boy': 79, u'kids': 412, u'colored': 425, u'luggage': 245, u'items': 356, u'leaves': 493, u'bow': 979, u'airport': 286, u'smoke': 931, u'action': 933, u'military': 776, u'couple': 77, u'narrow': 903, u'pillow': 820, u'sticking': 730, u'control': 688, u'apple': 473, u'family': 566, u'buses': 422, u'transit': 911, u'wii': 251, u'sliced': 672, u'snowboard': 344, u'motor': 555, u'toys': 924, u'parking': 205, u'market': 488, u'standing': 17, u'swings': 770, u'from': 97, u'takes': 687, u'working': 507, u'donuts': 403, u'pulling': 384, u'contains': 959, u'two': 16, u'rackets': 818, u'next': 21, u'few': 423, u'going': 273, u'overhead': 891, u'vehicle': 558, u'taken': 722, u'type': 876, u'horses': 192, u'flat': 689, u'door': 296, u'flying': 82, u'about': 350, u'chocolate': 450, u'trail': 756, u'flag': 808, u'carrying': 327, u'adult': 429, u'baby': 206, u'hole': 960, u'mounted': 614, u'women': 186, u'town': 575, u'grill': 954, u'animals': 298, u'room': 44, u'salad': 469, u'middle': 222, u'this': 141, u'car': 129, u'ride': 533, u'work': 723, u'roof': 892, u'cat': 51, u'decker': 357, u'donut': 520, u'can': 456, u'of': 6, u'making': 460, u'male': 367, u'veggies': 915, u'beautiful': 515, u'picture': 101, u'grassy': 213, u'floor': 197, u'pieces': 553, u'high': 351, u'foods': 717, u'carrot': 951, u'posing': 292, u'something': 336, u'cows': 240, u'pond': 893, u'airplane': 164, u'dress': 530, u'tan': 874, u'pink': 255, u'huge': 683, u'court': 152, u'winter': 969, u'sit': 227, u'onions': 816, u'six': 984, u'machine': 880, u'lamp': 585, u'forest': 427, u'animal': 370, u'elephant': 140, u'tile': 669, u'gate': 819, u'microwave': 408, u'toddler': 824, u'beach': 76, u'pizza': 67, u'plant': 581, u'sandwich': 188, u'helmet': 521, u'farm': 1001, u'watch': 475, u'after': 651, u'different': 193, u'tied': 878, u'jumping': 280, u'bear': 100, u'waves': 454, u'end': 621, u'vase': 204, u'lap': 586, u'types': 583, u'man': 12, u'a': 4, u'surfing': 377, u'neck': 673, u'crowded': 665, u'light': 174, u'counter': 185, u'eats': 804, u'shore': 559, u'truck': 125, u'shade': 945, u'vintage': 647, u'basket': 574, u'tall': 200, u'lined': 424, u'pulled': 670, u'playing': 57, u'wine': 237, u'cute': 623, u'holds': 259, u'shoes': 660, u'office': 477, u'piece': 238, u'over': 93, u'displayed': 451, u'meter': 480, u'held': 957, u'paper': 328, u'through': 105, u'motorcycle': 131, u'oven': 282, u'pitch': 547, u'smiling': 293, u'still': 943, u'its': 114, u'bunch': 171, u'<START>': 1, u'style': 732, u'group': 34, u'monitor': 463, u'backpack': 764, u'hot': 269, u'platform': 528, u'window': 126, u'orange': 190, u'covered': 135, u'soccer': 304, u'sauce': 554, u'into': 151, u'racquet': 359, u'them': 253, u'someone': 363, u'food': 61, u'school': 663, u'oranges': 434, u'number': 393, u'underneath': 527, u'boats': 295, u'walls': 484, u'giraffe': 119, u'they': 579, u'hands': 361, u'foot': 829, u'bath': 532, u'cage': 887, u'day': 218, u'bread': 439, u'down': 32, u'several': 94, u'rocky': 827, u'potatoes': 725, u'rocks': 470, u'stopped': 526, u'pan': 489, u'each': 134, u'crossing': 457, u'beneath': 953, u'tray': 380, u'side': 69, u'trailer': 863, u'glasses': 254, u'square': 768, u'elephants': 212, u'doing': 256, u'house': 332, u'fish': 830, u'hard': 997, u'buildings': 266, u'bowls': 600, u'books': 508, u'zebra': 183, u'girl': 96, u'enclosure': 396, u'sandy': 556, u'out': 87, u'living': 122, u'shown': 386, u'flower': 497, u'container': 702, u'opened': 990, u'driving': 230, u'space': 711, u'open': 132, u'surrounded': 400, u'looking': 72, u'race': 857, u'hill': 224, u'wide': 879, u'field': 35, u'get': 788, u'red': 48, u'shows': 546, u'foreground': 912, u'umbrella': 130, u'dirt': 220, u'<NULL>': 0, u'horse': 111, u'cart': 562, u'houses': 946, u'graze': 877, u'base': 535, u'rain': 495, u'guy': 323, u'swimming': 797, u'bushes': 697, u'yard': 534, u'shelves': 810, u'computers': 551, u'skateboard': 86, u'round': 767, u'turn': 869, u'plane': 180, u'place': 631, u'pepperoni': 932, u'swing': 438, u'snowboarding': 835, u'broken': 840, u'onto': 452, u'top': 33, u'cheese': 326, u'there': 65, u'features': 958, u'girls': 433, u'coming': 458, u'doughnuts': 591, u'scene': 466, u'fancy': 926, u'one': 107, u'feet': 678, u'lettuce': 993, u'floors': 839, u'another': 187, u'ties': 963, u'scissors': 388, u'cups': 826, u'electronic': 864, u'umbrellas': 281, u'<UNK>': 3, u'sheep': 163, u'city': 84, u'little': 145, u'toy': 426, u'hydrant': 179, u'jet': 346, u'bears': 339, u'leading': 970, u'bite': 896, u'pots': 889, u'plastic': 491, u'their': 102, u'leash': 947, u'station': 229, u'stuffed': 232, u'wrapped': 941, u'white': 22, u'legs': 728, u'banana': 320, u'store': 392, u'surfboard': 158, u'tomato': 985, u'eyes': 836, u'streets': 991, u'gear': 628, u'that': 26, u'shelf': 471, u'hotel': 587, u'park': 139, u'short': 940, u'flowers': 201, u'stairs': 796, u'photograph': 444, u'center': 655, u'steel': 668, u'jump': 604, u'kind': 882, u'double': 272, u'tree': 133, u'grey': 442, u'seated': 784, u'dogs': 314, u'shower': 355, u'stall': 815, u'apples': 467, u'fruits': 468, u'toward': 769, u'are': 20, u'and': 10, u'bridge': 405, u'urban': 902, u'well': 667, u'cattle': 635, u'ceiling': 858, u'glass': 175, u'talking': 278, u'graffiti': 643, u'pastry': 965, u'have': 449, u'seen': 472, u'breakfast': 754, u'mountain': 261, u'dishes': 729, u'person': 28, u'shorts': 750, u'snow': 73, u'couch': 169, u'lit': 483, u'equipment': 693, u'take': 648, u'doors': 849, u'green': 68, u'rides': 383, u'rider': 895, u'surf': 311, u'play': 407, u'towards': 487, u'multiple': 606, u'zebras': 215, u'track': 289, u'serve': 748, u'eggs': 846, u'who': 313, u'mouth': 375, u'eaten': 564, u'pair': 276, u'refrigerator': 252, u'cellphone': 538, u'lawn': 792, u'boys': 430, u'windows': 501, u'clear': 524, u'metal': 348, u'sale': 894, u'face': 358, u'sunset': 871, u'clean': 510, u'professional': 726, u'left': 638, u'painting': 760, u'lying': 368, u'shop': 627, u'walking': 56, u'shot': 541, u'kite': 154, u'gold': 934, u'show': 759, u'stove': 291, u'meal': 420, u'hillside': 794, u'colors': 927, u'serving': 733, u'parked': 66, u'bedroom': 331, u'perched': 572, u'corner': 271, u'chicken': 652, u'line': 365, u'blender': 785, u'tarmac': 577, u'giant': 707, u'busy': 366, u'pedestrians': 966, u'scooter': 949, u'behind': 143, u'ball': 75, u'wood': 318, u'black': 42, u'pretty': 610, u'riding': 46, u'watching': 285, u'rice': 602, u'wearing': 89, u'plate': 43, u'his': 40, u'sunglasses': 779, u'colorful': 299, u'suitcases': 710, u'rock': 529, u'sunny': 496, u'television': 290, u'trees': 128, u'vases': 550, u'batter': 394, u'tiled': 597, u'wedding': 805, u'during': 247, u'striped': 674, u'chips': 897, u'him': 382, u'gray': 389, u'bat': 157, u'catcher': 567, u'bar': 661, u'motorcycles': 324, u'trucks': 599, u'leather': 962, u'boarder': 872, u'modern': 592, u'public': 509, u'bag': 391, u'she': 679, u'including': 671, u'river': 335, u'where': 739, u'steam': 973, u'view': 172, u'set': 316, u'picnic': 900, u'throwing': 447, u'attached': 448, u'signs': 231, u'seat': 441, u'see': 853, u'computer': 118, u'bed': 74, u'sea': 907, u'skateboarding': 537, u'racket': 207, u'close': 138, u'arm': 700, u'wire': 755, u'lots': 322, u'pictures': 512, u'away': 714, u'carriage': 644, u'birds': 312, u'case': 561, u'outside': 121, u'various': 303, u'closed': 866, u'between': 416, u'it': 31, u'drawn': 813, u'hold': 909, u'before': 843, u'surfboards': 522, u'pants': 920, u'tables': 506, u'keyboard': 283, u'screen': 390, u'outdoors': 761, u'outfit': 998, u'toothbrush': 654, u'police': 517, u'tub': 414, u'surfer': 364, u'kitchen': 62, u'both': 692, u'mans': 904, u'cow': 267, u'restaurant': 341, u'country': 565, u'taking': 233, u'cup': 334, u'ramp': 354, u'event': 828, u'against': 321, u'restroom': 831, u'players': 329, u'doorway': 921, u'games': 771, u'passing': 557, u'nearby': 682, u'among': 807, u'flies': 636, u'pose': 719, u'toilet': 83, u'wall': 137, u'pot': 676, u'trunk': 686, u'walk': 342, u'pole': 275, u'towels': 886, u'church': 705, u'table': 24, u'desktop': 821, u'grazing': 244, u'boat': 166, u'bathroom': 58, u'teddy': 181, u'giraffes': 194, u'three': 78, u'been': 502, u'hitting': 474, u'beer': 616, u'peppers': 971, u'curtain': 873, u'brick': 345, u'staring': 727, u'hat': 250, u'containers': 989, u'board': 116, u'engine': 603, u'dry': 709, u'carrots': 404, u'commuter': 974, u'passengers': 613, u'fire': 148, u'airplanes': 718, u'clothing': 938, u'laptops': 590, u'photos': 910, u'controller': 544, u'child': 155, u'catch': 492, u'skiers': 432, u'land': 842, u'plants': 630, u'has': 54, u'stacked': 762, u'look': 402, u'plain': 939, u'runway': 325, u'as': 124, u'air': 123, u'trick': 279, u'while': 55, u'match': 656, u'many': 136, u'wild': 744, u'bathtub': 620, u'pool': 775, u'is': 11, u'walks': 419, u'lush': 476, u'coffee': 319, u'surface': 563, u'sleeping': 406, u'player': 90, u'reads': 905, u'swinging': 284, u'in': 8, u'ready': 223, u'sits': 98, u'mouse': 437, u'floating': 701, u'around': 106, u'bags': 653, u'containing': 640, u'bottles': 658, u'shirt': 189, u'things': 833, u'make': 955, u'bowl': 161, u'cross': 494, u'same': 773, u'beside': 243, u'vegetable': 884, u'party': 848, u'gets': 936, u'showing': 413, u'tomatoes': 690, u'used': 987, u'camera': 268, u'drink': 464, u'rail': 525, u'drives': 783, u'cement': 753, u'hand': 191, u'persons': 752, u'running': 362, u'fruit': 262, u'moving': 519, u'statue': 539, u'assortment': 789, u'stack': 1002, u'kid': 445, u'holding': 27, u'off': 214, u'reflection': 772, u'older': 431, u'no': 479, u'docked': 787, u'game': 92, u'ocean': 173, u'concrete': 650, u'edge': 523, u'bottle': 385, u'trains': 589, u'traffic': 177, u'the': 7, u'hotdog': 803, u'outdoor': 446, u'bananas': 211, u'just': 573, u'branch': 552, u'being': 209, u'photo': 162, u'laptop': 108, u'half': 399, u'cakes': 859, u'birthday': 481, u'mid': 809, u'front': 41, u'clocks': 800, u'rest': 944, u'zoo': 395, u'guys': 596, u'doughnut': 560, u'toilets': 908, u'cut': 379, u'snowboarder': 503, u'dining': 462, u'residential': 996, u'slices': 531, u'sky': 150, u'lake': 421, u'silver': 417, u'hay': 741, u'other': 70, u'pile': 418, u'kites': 264, u'throw': 778, u'wet': 568, u'intersection': 374, u'vanity': 977, u'ski': 265, u'skies': 817, u'skier': 353, u'which': 751, u'big': 168, u'skateboards': 691, u'someones': 860, u'looks': 288, u'fridge': 680, u'dark': 398, u'facing': 822, u'boxes': 677, u'five': 622, u'dock': 675, u'desk': 127, u'using': 310, u'railroad': 639, u'poses': 720, u'pier': 982, u'meat': 343, u'towel': 715, u'like': 376, u'shaped': 716, u'chairs': 287, u'sofa': 666, u'signal': 930, u'performing': 605, u'background': 159, u'controllers': 790, u'suitcase': 381, u'steps': 850, u'officer': 992, u'night': 337, u'served': 695, u'tower': 217, u'trying': 516, u'antique': 929, u'right': 645, u'old': 144, u'appliances': 612, u'crowd': 301, u'polar': 724, u'some': 30, u'back': 165, u'hair': 459, u'palm': 978, u'glove': 844, u'loaded': 928, u'pasture': 632, u'mother': 735, u'preparing': 372, u'electric': 983, u'plates': 307, u'candles': 626, u'for': 80, u'bottom': 890, u'purple': 435, u'ice': 841, u'pen': 618, u'does': 883, u'railing': 988, u'skateboarder': 330, u'christmas': 757, u'knife': 397, u'be': 333, u'says': 854, u'object': 937, u'run': 734, u'business': 782, u'reaching': 694, u'tour': 923, u'jumps': 811, u'decorative': 981, u'rug': 806, u'produce': 1000, u'soup': 780, u'putting': 708, u'pasta': 906, u'sandwiches': 657, u'post': 625, u'kneeling': 870, u'by': 50, u'highway': 763, u'on': 5, u'stone': 486, u'boards': 569, u'getting': 306, u'island': 994, u'surfers': 747, u'dinner': 571, u'empty': 277, u'toppings': 595, u'stand': 199, u'or': 540, u'road': 85, u'pastries': 885, u'image': 225, u'arms': 825, u'stop': 149, u'lies': 964, u'benches': 608, u'leaning': 455, u'brush': 646, u'female': 478, u'petting': 952, u'bikes': 518, u'van': 801, u'her': 88, u'area': 104, u'stainless': 832, u'vegetables': 210, u'tennis': 39, u'lone': 736, u'long': 249, u'desert': 852, u'cats': 453, u'low': 793, u'way': 410, u'suit': 260, u'dirty': 633, u'was': 942, u'across': 242, u'blurry': 967, u'fork': 465, u'mountains': 514, u'head': 235, u'himself': 898, u'an': 15, u'snowy': 246, u'bus': 64, u'atop': 703, u'pitcher': 609, u'landing': 838, u'cabinet': 740, u'cloth': 913, u'construction': 862, u'bun': 802, u'walkway': 914, u'remote': 352, u'broccoli': 248, u'ear': 901, u'with': 9, u'eat': 543, u'he': 378, u'boarding': 786, u'lady': 308, u'made': 387, u'arranged': 868, u'inside': 160, u'fries': 490, u'up': 36, u'placed': 549, u'below': 649, u'catching': 698, u'lays': 745, u'planes': 664, u'cake': 110, u'grass': 63, u'display': 258, u'distance': 598, u'skating': 851, u'passenger': 360, u'vehicles': 712, u'adults': 795, u'resting': 482, u'umpire': 781, u'mirror': 182, u'pie': 899, u'watches': 593, u'dog': 47, u'fly': 662, u'single': 588, u'curb': 634, u'at': 18, u'fashioned': 919, u'home': 347, u'ship': 976, u'flock': 845, u'cream': 731, u'hit': 309, u'jacket': 401, u'rainy': 999, u'cabinets': 428, u'variety': 601, u'not': 742, u'dressed': 369, u'assorted': 834, u'topped': 302, u'monitors': 867, u'painted': 485, u'book': 371, u'ledge': 814, u'papers': 986, u'tie': 216, u'trash': 823, u'nice': 545, u'brushing': 570, u'smiles': 743, u'frisbee': 120, u'kinds': 956, u'pillows': 685, u'setting': 504, u'prepared': 975, u'slice': 373, u'lunch': 855, u'nintendo': 584, u'prepares': 738, u'decorated': 415, u'pizzas': 578, u'friends': 861, u'sides': 916, u'structure': 968, u'building': 71, u'teeth': 499, u'coat': 856, u'fighter': 925, u'overlooking': 881, u'phone': 115, u'partially': 961, u'tricks': 611, u'lot': 198, u'together': 153, u'beds': 684, u'cooked': 766, u'train': 45, u'time': 542, u'fresh': 624, u'baked': 950, u'having': 536}
(Iteration 1 / 500) loss: 74.204380
(Iteration 51 / 500) loss: 35.977375
(Iteration 101 / 500) loss: 21.328795
(Iteration 151 / 500) loss: 11.396052
(Iteration 201 / 500) loss: 3.585956
(Iteration 251 / 500) loss: 2.669904
(Iteration 301 / 500) loss: 1.240664
(Iteration 351 / 500) loss: 0.438103
(Iteration 401 / 500) loss: 0.223871
(Iteration 451 / 500) loss: 0.095322